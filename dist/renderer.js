var Nt=Object.create;var at=Object.defineProperty;var Lt=Object.getOwnPropertyDescriptor;var It=Object.getOwnPropertyNames;var jt=Object.getPrototypeOf,Rt=Object.prototype.hasOwnProperty;var Ht=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var qt=(e,t,o,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of It(t))!Rt.call(e,r)&&r!==o&&at(e,r,{get:()=>t[r],enumerable:!(i=Lt(t,r))||i.enumerable});return e};var Bt=(e,t,o)=>(o=e!=null?Nt(jt(e)):{},qt(t||!e||!e.__esModule?at(o,"default",{value:e,enumerable:!0}):o,e));var bt=Ht((et,nt)=>{(function(e,t){typeof et=="object"&&typeof nt<"u"?nt.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self,e.dialogPolyfill=t())})(et,function(){"use strict";var e=window.CustomEvent;(!e||typeof e=="object")&&(e=function(s,a){a=a||{};var u=document.createEvent("CustomEvent");return u.initCustomEvent(s,!!a.bubbles,!!a.cancelable,a.detail||null),u},e.prototype=window.Event.prototype);function t(n,s){var a="on"+s.type.toLowerCase();return typeof n[a]=="function"&&n[a](s),n.dispatchEvent(s)}function o(n){for(;n&&n!==document.body;){var s=window.getComputedStyle(n),a=function(u,p){return!(s[u]===void 0||s[u]===p)};if(s.opacity<1||a("zIndex","auto")||a("transform","none")||a("mixBlendMode","normal")||a("filter","none")||a("perspective","none")||s.isolation==="isolate"||s.position==="fixed"||s.webkitOverflowScrolling==="touch")return!0;n=n.parentElement}return!1}function i(n){for(;n;){if(n.localName==="dialog")return n;n.parentElement?n=n.parentElement:n.parentNode?n=n.parentNode.host:n=null}return null}function r(n){for(;n&&n.shadowRoot&&n.shadowRoot.activeElement;)n=n.shadowRoot.activeElement;n&&n.blur&&n!==document.body&&n.blur()}function l(n,s){for(var a=0;a<n.length;++a)if(n[a]===s)return!0;return!1}function f(n){return!n||!n.hasAttribute("method")?!1:n.getAttribute("method").toLowerCase()==="dialog"}function d(n){var s=["button","input","keygen","select","textarea"],a=s.map(function(E){return E+":not([disabled])"});a.push('[tabindex]:not([disabled]):not([tabindex=""])');var u=n.querySelector(a.join(", "));if(!u&&"attachShadow"in Element.prototype)for(var p=n.querySelectorAll("*"),g=0;g<p.length&&!(p[g].tagName&&p[g].shadowRoot&&(u=d(p[g].shadowRoot),u));g++);return u}function _(n){return n.isConnected||document.body.contains(n)}function h(n){if(n.submitter)return n.submitter;var s=n.target;if(!(s instanceof HTMLFormElement))return null;var a=c.formSubmitter;if(!a){var u=n.target,p="getRootNode"in u&&u.getRootNode()||document;a=p.activeElement}return!a||a.form!==s?null:a}function x(n){if(!n.defaultPrevented){var s=n.target,a=c.imagemapUseValue,u=h(n);a===null&&u&&(a=u.value);var p=i(s);if(p){var g=u&&u.getAttribute("formmethod")||s.getAttribute("method");g==="dialog"&&(n.preventDefault(),a!=null?p.close(a):p.close())}}}function m(n){if(this.dialog_=n,this.replacedStyleTop_=!1,this.openAsModal_=!1,n.hasAttribute("role")||n.setAttribute("role","dialog"),n.show=this.show.bind(this),n.showModal=this.showModal.bind(this),n.close=this.close.bind(this),n.addEventListener("submit",x,!1),"returnValue"in n||(n.returnValue=""),"MutationObserver"in window){var s=new MutationObserver(this.maybeHideModal.bind(this));s.observe(n,{attributes:!0,attributeFilter:["open"]})}else{var a=!1,u=function(){a?this.downgradeModal():this.maybeHideModal(),a=!1}.bind(this),p,g=function(E){if(E.target===n){var A="DOMNodeRemoved";a|=E.type.substr(0,A.length)===A,window.clearTimeout(p),p=window.setTimeout(u,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(E){n.addEventListener(E,g)})}Object.defineProperty(n,"open",{set:this.setOpen.bind(this),get:n.hasAttribute.bind(n,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}m.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&_(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),c.dm.removeDialog(this))},setOpen:function(n){n?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(n){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var s=document.createElement("div");this.dialog_.insertBefore(s,this.dialog_.firstChild),s.tabIndex=-1,s.focus(),this.dialog_.removeChild(s)}var a=document.createEvent("MouseEvents");a.initMouseEvent(n.type,n.bubbles,n.cancelable,window,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget),this.dialog_.dispatchEvent(a),n.stopPropagation()},focus_:function(){var n=this.dialog_.querySelector("[autofocus]:not([disabled])");!n&&this.dialog_.tabIndex>=0&&(n=this.dialog_),n||(n=d(this.dialog_)),r(document.activeElement),n&&n.focus()},updateZIndex:function(n,s){if(n<s)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=n,this.backdrop_.style.zIndex=s},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!_(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!c.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");o(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,c.needsCentering(this.dialog_)?(c.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(n){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),n!==void 0&&(this.dialog_.returnValue=n);var s=new e("close",{bubbles:!1,cancelable:!1});t(this.dialog_,s)}};var c={};if(c.reposition=function(n){var s=document.body.scrollTop||document.documentElement.scrollTop,a=s+(window.innerHeight-n.offsetHeight)/2;n.style.top=Math.max(s,a)+"px"},c.isInlinePositionSetByStylesheet=function(n){for(var s=0;s<document.styleSheets.length;++s){var a=document.styleSheets[s],u=null;try{u=a.cssRules}catch{}if(u)for(var p=0;p<u.length;++p){var g=u[p],E=null;try{E=document.querySelectorAll(g.selectorText)}catch{}if(!(!E||!l(E,n))){var A=g.style.getPropertyValue("top"),st=g.style.getPropertyValue("bottom");if(A&&A!=="auto"||st&&st!=="auto")return!0}}}return!1},c.needsCentering=function(n){var s=window.getComputedStyle(n);return s.position!=="absolute"||n.style.top!=="auto"&&n.style.top!==""||n.style.bottom!=="auto"&&n.style.bottom!==""?!1:!c.isInlinePositionSetByStylesheet(n)},c.forceRegisterDialog=function(n){if((window.HTMLDialogElement||n.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",n),n.localName!=="dialog")throw new Error("Failed to register dialog: The element is not a dialog.");new m(n)},c.registerDialog=function(n){n.showModal||c.forceRegisterDialog(n)},c.DialogManager=function(){this.pendingDialogStack=[];var n=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(s){this.forwardTab_=void 0,s.stopPropagation(),n([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=1e5+150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(s){var a=[];s.forEach(function(u){for(var p=0,g;g=u.removedNodes[p];++p){if(g instanceof Element)g.localName==="dialog"&&a.push(g);else continue;a=a.concat(g.querySelectorAll("dialog"))}}),a.length&&n(a)}))},c.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},c.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},c.DialogManager.prototype.updateStacking=function(){for(var n=this.zIndexHigh_,s=0,a;a=this.pendingDialogStack[s];++s)a.updateZIndex(--n,--n),s===0&&(this.overlay.style.zIndex=--n);var u=this.pendingDialogStack[0];if(u){var p=u.dialog.parentNode||document.body;p.appendChild(this.overlay)}else this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},c.DialogManager.prototype.containedByTopDialog_=function(n){for(;n=i(n);){for(var s=0,a;a=this.pendingDialogStack[s];++s)if(a.dialog===n)return s===0;n=n.parentElement}return!1},c.DialogManager.prototype.handleFocus_=function(n){var s=n.composedPath?n.composedPath()[0]:n.target;if(!this.containedByTopDialog_(s)&&document.activeElement!==document.documentElement&&(n.preventDefault(),n.stopPropagation(),r(s),this.forwardTab_!==void 0)){var a=this.pendingDialogStack[0],u=a.dialog,p=u.compareDocumentPosition(s);return p&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?a.focus_():s!==document.documentElement&&document.documentElement.focus()),!1}},c.DialogManager.prototype.handleKey_=function(n){if(this.forwardTab_=void 0,n.keyCode===27){n.preventDefault(),n.stopPropagation();var s=new e("cancel",{bubbles:!1,cancelable:!0}),a=this.pendingDialogStack[0];a&&t(a.dialog,s)&&a.dialog.close()}else n.keyCode===9&&(this.forwardTab_=!n.shiftKey)},c.DialogManager.prototype.checkDOM_=function(n){var s=this.pendingDialogStack.slice();s.forEach(function(a){n.indexOf(a.dialog)!==-1?a.downgradeModal():a.maybeHideModal()})},c.DialogManager.prototype.pushDialog=function(n){var s=(this.zIndexHigh_-this.zIndexLow_)/2-1;return this.pendingDialogStack.length>=s?!1:(this.pendingDialogStack.unshift(n)===1&&this.blockDocument(),this.updateStacking(),!0)},c.DialogManager.prototype.removeDialog=function(n){var s=this.pendingDialogStack.indexOf(n);s!==-1&&(this.pendingDialogStack.splice(s,1),this.pendingDialogStack.length===0&&this.unblockDocument(),this.updateStacking())},c.dm=new c.DialogManager,c.formSubmitter=null,c.imagemapUseValue=null,window.HTMLDialogElement===void 0){var $=document.createElement("form");if($.setAttribute("method","dialog"),$.method!=="dialog"){var y=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(y){var R=y.get;y.get=function(){return f(this)?"dialog":R.call(this)};var G=y.set;y.set=function(n){return typeof n=="string"&&n.toLowerCase()==="dialog"?this.setAttribute("method",n):G.call(this,n)},Object.defineProperty(HTMLFormElement.prototype,"method",y)}}document.addEventListener("click",function(n){if(c.formSubmitter=null,c.imagemapUseValue=null,!n.defaultPrevented){var s=n.target;if("composedPath"in n){var a=n.composedPath();s=a.shift()||s}if(!(!s||!f(s.form))){var u=s.type==="submit"&&["button","input"].indexOf(s.localName)>-1;if(!u){if(!(s.localName==="input"&&s.type==="image"))return;c.imagemapUseValue=n.offsetX+","+n.offsetY}var p=i(s);p&&(c.formSubmitter=s)}}},!1),document.addEventListener("submit",function(n){var s=n.target,a=i(s);if(!a){var u=h(n),p=u&&u.getAttribute("formmethod")||s.getAttribute("method");p==="dialog"&&n.preventDefault()}});var W=HTMLFormElement.prototype.submit,O=function(){if(!f(this))return W.call(this);var n=i(this);n&&n.close()};HTMLFormElement.prototype.submit=O}return c})});var zt=e=>{let t=new Set;do for(let o of Reflect.ownKeys(e))t.add([e,o]);while((e=Reflect.getPrototypeOf(e))&&e!==Object.prototype);return t};function X(e,{include:t,exclude:o}={}){let i=r=>{let l=f=>typeof f=="string"?r===f:f.test(r);return t?t.some(l):o?!o.some(l):!0};for(let[r,l]of zt(e.constructor.prototype)){if(l==="constructor"||!i(l))continue;let f=Reflect.getOwnPropertyDescriptor(r,l);f&&typeof f.value=="function"&&(e[l]=e[l].bind(e))}return e}function b(){}function Q(e){return e()}function lt(){return Object.create(null)}function T(e){e.forEach(Q)}function L(e){return typeof e=="function"}function I(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function ut(e){return Object.keys(e).length===0}var ft=!1;function Ut(){ft=!0}function Vt(){ft=!1}function v(e,t){e.appendChild(t)}function B(e,t,o){e.insertBefore(t,o||null)}function j(e){e.parentNode&&e.parentNode.removeChild(e)}function dt(e,t){for(let o=0;o<e.length;o+=1)e[o]&&e[o].d(t)}function k(e){return document.createElement(e)}function P(e){return document.createTextNode(e)}function z(){return P(" ")}function ht(){return P("")}function pt(e,t,o,i){return e.addEventListener(t,o,i),()=>e.removeEventListener(t,o,i)}function w(e,t,o){o==null?e.removeAttribute(t):e.getAttribute(t)!==o&&e.setAttribute(t,o)}function Kt(e){return Array.from(e.childNodes)}var tt;function N(e){tt=e}var M=[];var H=[],D=[],ct=[],Gt=Promise.resolve(),J=!1;function Wt(){J||(J=!0,Gt.then(mt))}function Z(e){D.push(e)}var Y=new Set,S=0;function mt(){if(S!==0)return;let e=tt;do{try{for(;S<M.length;){let t=M[S];S++,N(t),Xt(t.$$)}}catch(t){throw M.length=0,S=0,t}for(N(null),M.length=0,S=0;H.length;)H.pop()();for(let t=0;t<D.length;t+=1){let o=D[t];Y.has(o)||(Y.add(o),o())}D.length=0}while(M.length);for(;ct.length;)ct.pop()();J=!1,Y.clear(),N(e)}function Xt(e){if(e.fragment!==null){e.update(),T(e.before_update);let t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Z)}}function Yt(e){let t=[],o=[];D.forEach(i=>e.indexOf(i)===-1?t.push(i):o.push(i)),o.forEach(i=>i()),D=t}var Jt=new Set;function Zt(e,t){e&&e.i&&(Jt.delete(e),e.i(t))}var ve=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var Qt=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],we=new Set([...Qt]);function te(e,t,o,i){let{fragment:r,after_update:l}=e.$$;r&&r.m(t,o),i||Z(()=>{let f=e.$$.on_mount.map(Q).filter(L);e.$$.on_destroy?e.$$.on_destroy.push(...f):T(f),e.$$.on_mount=[]}),l.forEach(Z)}function _t(e,t){let o=e.$$;o.fragment!==null&&(Yt(o.after_update),T(o.on_destroy),o.fragment&&o.fragment.d(t),o.on_destroy=o.fragment=null,o.ctx=[])}function ee(e,t){e.$$.dirty[0]===-1&&(M.push(e),Wt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function gt(e,t,o,i,r,l,f,d=[-1]){let _=tt;N(e);let h=e.$$={fragment:null,ctx:[],props:l,update:b,not_equal:r,bound:lt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(_?_.$$.context:[])),callbacks:lt(),dirty:d,skip_bound:!1,root:t.target||_.$$.root};f&&f(h.root);let x=!1;if(h.ctx=o?o(e,t.props||{},(m,c,...$)=>{let y=$.length?$[0]:c;return h.ctx&&r(h.ctx[m],h.ctx[m]=y)&&(!h.skip_bound&&h.bound[m]&&h.bound[m](y),x&&ee(e,m)),c}):[],h.update(),x=!0,T(h.before_update),h.fragment=i?i(h.ctx):!1,t.target){if(t.hydrate){Ut();let m=Kt(t.target);h.fragment&&h.fragment.l(m),m.forEach(j)}else h.fragment&&h.fragment.c();t.intro&&Zt(e.$$.fragment),te(e,t.target,t.anchor,t.customElement),Vt(),mt()}N(_)}var ne;typeof HTMLElement=="function"&&(ne=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(Q).filter(L);for(let t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(e,t,o){this[e]=o}disconnectedCallback(){T(this.$$.on_disconnect)}$destroy(){_t(this,1),this.$destroy=b}$on(e,t){if(!L(t))return b;let o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{let i=o.indexOf(t);i!==-1&&o.splice(i,1)}}$set(e){this.$$set&&!ut(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});var q=class{$destroy(){_t(this,1),this.$destroy=b}$on(t,o){if(!L(o))return b;let i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(o),()=>{let r=i.indexOf(o);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!ut(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}};var C=[];function yt(e,t=b){let o,i=new Set;function r(d){if(I(e,d)&&(e=d,o)){let _=!C.length;for(let h of i)h[1](),C.push(h,e);if(_){for(let h=0;h<C.length;h+=2)C[h][0](C[h+1]);C.length=0}}}function l(d){r(d(e))}function f(d,_=b){let h=[d,_];return i.add(h),i.size===1&&(o=t(r)||b),d(e),()=>{i.delete(h),i.size===0&&o&&(o(),o=null)}}return{set:r,update:l,subscribe:f}}var Dt=Bt(bt());var wt=(e,t)=>{let o=Object.keys(e);return o.length!==Object.keys(t).length?!1:o.every(i=>Object.prototype.hasOwnProperty.call(t,i)&&e[i]===t[i])},oe=(e,t)=>e.length===t.length&&e.every((o,i)=>wt(o,t[i])),ie=(e,t)=>{if(e.length<t.length)return!1;let o=e.length-t.length;for(let i=t.length-1;i>=0;i-=1)if(!wt(e[o+i],t[i]))return!1;return!0},Et=e=>e.reduce((t,o)=>({...t,[o]:!0}),{}),xt=["ctrl","shift","alt","meta"],re=Et(xt),se=e=>Object.keys(e).filter(t=>!re[t]).length===1,U=(e,t)=>{if(!e)throw new Error(t)},V=(e,t,o)=>{U(typeof e===o,`The ${t} must be a ${o}; given ${typeof e}`)},kt=e=>e.split(/ +/g).map(t=>{let o=t.split("+").filter(Boolean),i=Et(o);return U(Object.keys(i).length>=o.length,`Hotkey combination has duplicates "${e}"`),U(se(i),`Invalid hotkey combination: "${e}"`),i}),ae=(e,t)=>{V(e,"hotkey","string"),V(t,"callback","function")},vt=(e,t)=>(o,i)=>{ae(o,i),t(e,o,i)},le=(e,t,o)=>{e.push({hotkey:kt(t),callback:o})},ce=(e,t,o)=>{let i=kt(t),r=e.findIndex(l=>l.callback===o&&oe(i,l.hotkey));r!==-1&&e.splice(r,1)},ue=(e,t)=>{let o=null;return()=>{clearTimeout(o),o=setTimeout(e,t)}},fe=e=>{switch(e){case"+":return"plus";case" ":return"space";default:return e.toLowerCase()}},de=(e,t)=>{let o=[],i=ue(()=>{o=[]},t);return r=>{if(r.repeat||r.getModifierState(r.key))return;i();let l={[fe(r.key)]:!0};xt.forEach(f=>{r[`${f}Key`]&&(l[f]=!0)}),o.push(l),e.forEach(f=>{ie(o,f.hotkey)&&f.callback(r)})}},he=e=>{let{debounceTime:t=500,autoEnable:o=!0}=e||{};return V(t,"debounceTime","number"),U(t>0,"debounceTime must be > 0"),V(o,"autoEnable","boolean"),{debounceTime:t,autoEnable:o}},$t=e=>{let{debounceTime:t,autoEnable:o}=he(e),i=[],r=de(i,t),l=()=>document.addEventListener("keydown",r),f=()=>document.removeEventListener("keydown",r);return o&&l(),{register:vt(i,le),unregister:vt(i,ce),enable:l,disable:f}};function Ft(e,t,o){let i=e.slice();i[8]=t[o];let r=i[2][i[8]];return i[9]=r,i}function St(e){let t,o,i=e[8]+"",r,l,f,d,_=e[9].valid==="unknown"?"Validity Unknown":e[9].valid?"Valid":"Invalid",h,x,m,c,$=e[9].enabled?"Disable":"Enable",y,R,G,W,O,n;function s(){return e[3](e[8])}return{c(){t=k("div"),o=k("h1"),r=P(i),l=z(),f=k("div"),d=k("span"),h=P(_),m=z(),c=k("button"),y=P($),R=z(),w(o,"class","PopcornUI-theme-id"),w(d,"class","PopcornUI-valid"),w(d,"data-value",x=e[9].valid),w(f,"class","PopcornUI-meta"),w(c,"class","PopcornUI-theme-toggle"),w(t,"class","PopcornUI-theme"),w(t,"id",G=e[8]),w(t,"data-enabled",W=e[9].enabled)},m(a,u){B(a,t,u),v(t,o),v(o,r),v(t,l),v(t,f),v(f,d),v(d,h),v(t,m),v(t,c),v(c,y),v(t,R),O||(n=pt(c,"click",s),O=!0)},p(a,u){e=a},d(a){a&&j(t),O=!1,n()}}}function Mt(e){let t=e[1]?.[e[8]],o,i=St(e);return{c(){i.c(),o=ht()},m(r,l){i.m(r,l),B(r,o,l)},p(r,l){l&2&&I(t,t=r[1]?.[r[8]])?(i.d(1),i=St(r),i.c(),i.m(o.parentNode,o)):i.p(r,l)},d(r){r&&j(o),i.d(r)}}}function pe(e){let t,o,i=Object.keys(e[2]),r=[];for(let l=0;l<i.length;l+=1)r[l]=Mt(Ft(e,i,l));return{c(){t=k("dialog"),o=k("div");for(let l=0;l<r.length;l+=1)r[l].c();w(o,"class","PopcornUI-themes-wrapper"),w(t,"class","PopcornUI-dialog")},m(l,f){B(l,t,f),v(t,o);for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(o,null);e[4](t)},p(l,[f]){if(f&6){i=Object.keys(l[2]);let d;for(d=0;d<i.length;d+=1){let _=Ft(l,i,d);r[d]?r[d].p(_,f):(r[d]=Mt(_),r[d].c(),r[d].m(o,null))}for(;d<r.length;d+=1)r[d].d(1);r.length=i.length}},i:b,o:b,d(l){l&&j(t),dt(r,l),e[4](null)}}}var ot=yt();function Tt(e){ot.set(e)}var me=await PopcornNative.config;function _e(e,t,o){let i=Popcorn.themes,r;let l=!1;function f(){l?r.close():r.showModal(),l=!l,document.documentElement.dataset.popcornUiOpen=l.toString()}let d=$t();d.register(me.hotkey,m=>{m.stopImmediatePropagation(),f()}),d.register("escape",m=>{l&&(m.stopImmediatePropagation(),f())});let _={};ot.subscribe(m=>{o(1,_[m]=!_?.[m],_),ot.set(null)});let h=m=>window.Popcorn.toggle(m);function x(m){H[m?"unshift":"push"](()=>{r=m,o(0,r)})}return[r,_,i,h,x]}var it=class extends q{constructor(t){super(),gt(this,t,_e,pe,I,{})}},Pt=it;var Ct={str:"gold",arr:[255,215,0]},rt=class{constructor(t,o="console"){this.log=(...t)=>this.#t("log",t);this.info=(...t)=>this.#t("info",t);this.warn=(...t)=>this.#t("warn",t);this.error=(...t)=>this.#t("error",t);this.debug=(...t)=>this.#t("debug",t);this.module=t,this.output=this.#e(o)}#e(t){switch(t){case"ansi":case"terminal":return"ansi";default:return"console"}}#n(t){switch(t){case"info":case"warn":case"error":case"debug":return t;default:return"log"}}#o(t){switch(t){case"debug":return{str:"MediumSpringGreen",arr:[0,250,154]};case"info":return{str:"DeepSkyBlue",arr:[0,191,255]};case"error":return{str:"crimson",arr:[220,20,60]};case"warn":return{str:"DarkOrange",arr:[255,140,0]};default:return null}}#i(t,o){return`\x1B[38;2;${t[0]};${t[1]};${t[2]}m${o}\x1B[0m`}#t(t,o){let i=this.#o(t)??Ct,r=this.output==="ansi"?[`[${this.#i(i.arr,"Popcorn")} > ${this.module}]`]:[`[%cPopcorn%c > ${this.module}]`,`color: ${i.str||Ct.str};`,""];console[this.#n(t)](...r,...o)}},K=rt;var Qe=new K("Proxy"),Ot={get(e,t){return typeof e[t]=="object"&&e[t]!==null?new Proxy(e[t],this):e[t]},set:(e,t,o)=>(Tt(e.id),e[t]=o,!0)};var F=new K("Renderer"),ge=await PopcornNative.config,an=new class{comments;themeCache=new Map;themeProxy;shouldValidate;constructor(){this.shouldValidate=PopcornNative.validateCSS!==null,X(this)}async start(){let o={themes:await PopcornNative.getThemes(),enable:this.enable,disable:this.disable,toggle:this.toggle};this.themeProxy=new Proxy(o.themes,Ot),o.themes=this.themeProxy,window.Popcorn=o;let i=document.createComment("section:Popcorn"),r=document.createComment("endsection");document.head.append(i,r),this.comments={start:i,end:r},new Pt({target:document.body}),this.populateThemes(),this.watchThemes()}async populateThemes(){for(let t of Object.keys(this.themeProxy)){let o=this.themeProxy[t];this.populateTheme(t),o.enabled&&await this.enable(t,!1)}}async watchThemes(){PopcornNative.onThemeChange(({id:t,theme:o})=>{ge.verbose&&F.debug(`Theme changed: ${t}`),this.themeProxy[t]=o,this.populateTheme(t),this.updateTheme(t)})}async updateTheme(t){let o=this.themeCache.get(t);if(!o){F.warn(`No theme found with id: "${t}"`);return}o.textContent=this.themeProxy[t].css}async populateTheme(t){let o=this.themeProxy[t];o.enable=(i=!0)=>this.enable(t,i),o.disable=(i=!0)=>this.disable(t,i),o.toggle=(i=!0)=>this.toggle(t,i),o.valid="unknown",this.validateTheme(t)}async validateTheme(t){if(!this.shouldValidate)return;let o=this.themeProxy[t];PopcornNative.validateCSS(o.css).then(i=>{o.valid=!!i.valid}).catch(i=>{F.error(`Failed to validate "${t}".`,i),o.valid="unknown"})}enable(t,o=!0){let i=this.themeProxy[t];if(i.enabled=!0,this.themeCache.has(t)){F.log(`"${t}" is already enabled.`);return}let r=document.createElement("style");r.id=t,r.textContent=i.css,r.dataset.popcorn="true",this.comments.end.before(r),this.themeCache.set(t,r),PopcornNative.watchTheme(JSON.stringify(i)),F.log(`"${t}" enabled.`),o&&PopcornNative.saveState(t,!0)}disable(t,o=!0){let i=this.themeProxy[t];i.enabled=!1;let r=this.themeCache.get(t);if(!r){F.warn(`"${t}" is not enabled.`);return}this.themeCache.delete(t),r.remove(),PopcornNative.unwatchTheme(JSON.stringify(i)),F.log(`"${t}" disabled.`),o&&PopcornNative.saveState(t,!1)}toggle(t,o=!0){this.themeProxy[t].enabled?this.disable(t,o):this.enable(t,o)}async stop(){delete window.Popcorn;let t=[...document.querySelectorAll("[data-popcorn]"),...Object.values(this.comments)];for(let o of t)o.remove()}};export{an as default};
