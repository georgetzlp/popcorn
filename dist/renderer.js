var Nt=Object.create;var rt=Object.defineProperty;var Lt=Object.getOwnPropertyDescriptor;var It=Object.getOwnPropertyNames;var jt=Object.getPrototypeOf,Rt=Object.prototype.hasOwnProperty;var Ht=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var qt=(e,t,o,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of It(t))!Rt.call(e,r)&&r!==o&&rt(e,r,{get:()=>t[r],enumerable:!(i=Lt(t,r))||i.enumerable});return e};var zt=(e,t,o)=>(o=e!=null?Nt(jt(e)):{},qt(t||!e||!e.__esModule?rt(o,"default",{value:e,enumerable:!0}):o,e));var gt=Ht((Q,tt)=>{(function(e,t){typeof Q=="object"&&typeof tt<"u"?tt.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self,e.dialogPolyfill=t())})(Q,function(){"use strict";var e=window.CustomEvent;(!e||typeof e=="object")&&(e=function(s,c){c=c||{};var d=document.createEvent("CustomEvent");return d.initCustomEvent(s,!!c.bubbles,!!c.cancelable,c.detail||null),d},e.prototype=window.Event.prototype);function t(n,s){var c="on"+s.type.toLowerCase();return typeof n[c]=="function"&&n[c](s),n.dispatchEvent(s)}function o(n){for(;n&&n!==document.body;){var s=window.getComputedStyle(n),c=function(d,p){return!(s[d]===void 0||s[d]===p)};if(s.opacity<1||c("zIndex","auto")||c("transform","none")||c("mixBlendMode","normal")||c("filter","none")||c("perspective","none")||s.isolation==="isolate"||s.position==="fixed"||s.webkitOverflowScrolling==="touch")return!0;n=n.parentElement}return!1}function i(n){for(;n;){if(n.localName==="dialog")return n;n.parentElement?n=n.parentElement:n.parentNode?n=n.parentNode.host:n=null}return null}function r(n){for(;n&&n.shadowRoot&&n.shadowRoot.activeElement;)n=n.shadowRoot.activeElement;n&&n.blur&&n!==document.body&&n.blur()}function l(n,s){for(var c=0;c<n.length;++c)if(n[c]===s)return!0;return!1}function u(n){return!n||!n.hasAttribute("method")?!1:n.getAttribute("method").toLowerCase()==="dialog"}function f(n){var s=["button","input","keygen","select","textarea"],c=s.map(function(v){return v+":not([disabled])"});c.push('[tabindex]:not([disabled]):not([tabindex=""])');var d=n.querySelector(c.join(", "));if(!d&&"attachShadow"in Element.prototype)for(var p=n.querySelectorAll("*"),_=0;_<p.length&&!(p[_].tagName&&p[_].shadowRoot&&(d=f(p[_].shadowRoot),d));_++);return d}function m(n){return n.isConnected||document.body.contains(n)}function h(n){if(n.submitter)return n.submitter;var s=n.target;if(!(s instanceof HTMLFormElement))return null;var c=a.formSubmitter;if(!c){var d=n.target,p="getRootNode"in d&&d.getRootNode()||document;c=p.activeElement}return!c||c.form!==s?null:c}function g(n){if(!n.defaultPrevented){var s=n.target,c=a.imagemapUseValue,d=h(n);c===null&&d&&(c=d.value);var p=i(s);if(p){var _=d&&d.getAttribute("formmethod")||s.getAttribute("method");_==="dialog"&&(n.preventDefault(),c!=null?p.close(c):p.close())}}}function y(n){if(this.dialog_=n,this.replacedStyleTop_=!1,this.openAsModal_=!1,n.hasAttribute("role")||n.setAttribute("role","dialog"),n.show=this.show.bind(this),n.showModal=this.showModal.bind(this),n.close=this.close.bind(this),n.addEventListener("submit",g,!1),"returnValue"in n||(n.returnValue=""),"MutationObserver"in window){var s=new MutationObserver(this.maybeHideModal.bind(this));s.observe(n,{attributes:!0,attributeFilter:["open"]})}else{var c=!1,d=function(){c?this.downgradeModal():this.maybeHideModal(),c=!1}.bind(this),p,_=function(v){if(v.target===n){var C="DOMNodeRemoved";c|=v.type.substr(0,C.length)===C,window.clearTimeout(p),p=window.setTimeout(d,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(v){n.addEventListener(v,_)})}Object.defineProperty(n,"open",{set:this.setOpen.bind(this),get:n.hasAttribute.bind(n,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}y.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&m(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),a.dm.removeDialog(this))},setOpen:function(n){n?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(n){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var s=document.createElement("div");this.dialog_.insertBefore(s,this.dialog_.firstChild),s.tabIndex=-1,s.focus(),this.dialog_.removeChild(s)}var c=document.createEvent("MouseEvents");c.initMouseEvent(n.type,n.bubbles,n.cancelable,window,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget),this.dialog_.dispatchEvent(c),n.stopPropagation()},focus_:function(){var n=this.dialog_.querySelector("[autofocus]:not([disabled])");!n&&this.dialog_.tabIndex>=0&&(n=this.dialog_),n||(n=f(this.dialog_)),r(document.activeElement),n&&n.focus()},updateZIndex:function(n,s){if(n<s)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=n,this.backdrop_.style.zIndex=s},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!m(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!a.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");o(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,a.needsCentering(this.dialog_)?(a.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(n){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),n!==void 0&&(this.dialog_.returnValue=n);var s=new e("close",{bubbles:!1,cancelable:!1});t(this.dialog_,s)}};var a={};if(a.reposition=function(n){var s=document.body.scrollTop||document.documentElement.scrollTop,c=s+(window.innerHeight-n.offsetHeight)/2;n.style.top=Math.max(s,c)+"px"},a.isInlinePositionSetByStylesheet=function(n){for(var s=0;s<document.styleSheets.length;++s){var c=document.styleSheets[s],d=null;try{d=c.cssRules}catch{}if(d)for(var p=0;p<d.length;++p){var _=d[p],v=null;try{v=document.querySelectorAll(_.selectorText)}catch{}if(!(!v||!l(v,n))){var C=_.style.getPropertyValue("top"),it=_.style.getPropertyValue("bottom");if(C&&C!=="auto"||it&&it!=="auto")return!0}}}return!1},a.needsCentering=function(n){var s=window.getComputedStyle(n);return s.position!=="absolute"||n.style.top!=="auto"&&n.style.top!==""||n.style.bottom!=="auto"&&n.style.bottom!==""?!1:!a.isInlinePositionSetByStylesheet(n)},a.forceRegisterDialog=function(n){if((window.HTMLDialogElement||n.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",n),n.localName!=="dialog")throw new Error("Failed to register dialog: The element is not a dialog.");new y(n)},a.registerDialog=function(n){n.showModal||a.forceRegisterDialog(n)},a.DialogManager=function(){this.pendingDialogStack=[];var n=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(s){this.forwardTab_=void 0,s.stopPropagation(),n([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=1e5+150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(s){var c=[];s.forEach(function(d){for(var p=0,_;_=d.removedNodes[p];++p){if(_ instanceof Element)_.localName==="dialog"&&c.push(_);else continue;c=c.concat(_.querySelectorAll("dialog"))}}),c.length&&n(c)}))},a.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},a.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},a.DialogManager.prototype.updateStacking=function(){for(var n=this.zIndexHigh_,s=0,c;c=this.pendingDialogStack[s];++s)c.updateZIndex(--n,--n),s===0&&(this.overlay.style.zIndex=--n);var d=this.pendingDialogStack[0];if(d){var p=d.dialog.parentNode||document.body;p.appendChild(this.overlay)}else this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},a.DialogManager.prototype.containedByTopDialog_=function(n){for(;n=i(n);){for(var s=0,c;c=this.pendingDialogStack[s];++s)if(c.dialog===n)return s===0;n=n.parentElement}return!1},a.DialogManager.prototype.handleFocus_=function(n){var s=n.composedPath?n.composedPath()[0]:n.target;if(!this.containedByTopDialog_(s)&&document.activeElement!==document.documentElement&&(n.preventDefault(),n.stopPropagation(),r(s),this.forwardTab_!==void 0)){var c=this.pendingDialogStack[0],d=c.dialog,p=d.compareDocumentPosition(s);return p&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?c.focus_():s!==document.documentElement&&document.documentElement.focus()),!1}},a.DialogManager.prototype.handleKey_=function(n){if(this.forwardTab_=void 0,n.keyCode===27){n.preventDefault(),n.stopPropagation();var s=new e("cancel",{bubbles:!1,cancelable:!0}),c=this.pendingDialogStack[0];c&&t(c.dialog,s)&&c.dialog.close()}else n.keyCode===9&&(this.forwardTab_=!n.shiftKey)},a.DialogManager.prototype.checkDOM_=function(n){var s=this.pendingDialogStack.slice();s.forEach(function(c){n.indexOf(c.dialog)!==-1?c.downgradeModal():c.maybeHideModal()})},a.DialogManager.prototype.pushDialog=function(n){var s=(this.zIndexHigh_-this.zIndexLow_)/2-1;return this.pendingDialogStack.length>=s?!1:(this.pendingDialogStack.unshift(n)===1&&this.blockDocument(),this.updateStacking(),!0)},a.DialogManager.prototype.removeDialog=function(n){var s=this.pendingDialogStack.indexOf(n);s!==-1&&(this.pendingDialogStack.splice(s,1),this.pendingDialogStack.length===0&&this.unblockDocument(),this.updateStacking())},a.dm=new a.DialogManager,a.formSubmitter=null,a.imagemapUseValue=null,window.HTMLDialogElement===void 0){var E=document.createElement("form");if(E.setAttribute("method","dialog"),E.method!=="dialog"){var w=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(w){var $=w.get;w.get=function(){return u(this)?"dialog":$.call(this)};var R=w.set;w.set=function(n){return typeof n=="string"&&n.toLowerCase()==="dialog"?this.setAttribute("method",n):R.call(this,n)},Object.defineProperty(HTMLFormElement.prototype,"method",w)}}document.addEventListener("click",function(n){if(a.formSubmitter=null,a.imagemapUseValue=null,!n.defaultPrevented){var s=n.target;if("composedPath"in n){var c=n.composedPath();s=c.shift()||s}if(!(!s||!u(s.form))){var d=s.type==="submit"&&["button","input"].indexOf(s.localName)>-1;if(!d){if(!(s.localName==="input"&&s.type==="image"))return;a.imagemapUseValue=n.offsetX+","+n.offsetY}var p=i(s);p&&(a.formSubmitter=s)}}},!1),document.addEventListener("submit",function(n){var s=n.target,c=i(s);if(!c){var d=h(n),p=d&&d.getAttribute("formmethod")||s.getAttribute("method");p==="dialog"&&n.preventDefault()}});var Pt=HTMLFormElement.prototype.submit,Ct=function(){if(!u(this))return Pt.call(this);var n=i(this);n&&n.close()};HTMLFormElement.prototype.submit=Ct}return a})});var Bt=e=>{let t=new Set;do for(let o of Reflect.ownKeys(e))t.add([e,o]);while((e=Reflect.getPrototypeOf(e))&&e!==Object.prototype);return t};function V(e,{include:t,exclude:o}={}){let i=r=>{let l=u=>typeof u=="string"?r===u:u.test(r);return t?t.some(l):o?!o.some(l):!0};for(let[r,l]of Bt(e.constructor.prototype)){if(l==="constructor"||!i(l))continue;let u=Reflect.getOwnPropertyDescriptor(r,l);u&&typeof u.value=="function"&&(e[l]=e[l].bind(e))}return e}function b(){}function Y(e){return e()}function st(){return Object.create(null)}function D(e){e.forEach(Y)}function N(e){return typeof e=="function"}function L(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function lt(e){return Object.keys(e).length===0}var at=!1;function Kt(){at=!0}function Ut(){at=!1}function x(e,t){e.appendChild(t)}function z(e,t,o){e.insertBefore(t,o||null)}function I(e){e.parentNode&&e.parentNode.removeChild(e)}function ut(e,t){for(let o=0;o<e.length;o+=1)e[o]&&e[o].d(t)}function T(e){return document.createElement(e)}function j(e){return document.createTextNode(e)}function J(){return j(" ")}function ft(){return j("")}function dt(e,t,o,i){return e.addEventListener(t,o,i),()=>e.removeEventListener(t,o,i)}function k(e,t,o){o==null?e.removeAttribute(t):e.getAttribute(t)!==o&&e.setAttribute(t,o)}function Vt(e){return Array.from(e.childNodes)}var Z;function A(e){Z=e}var S=[];var H=[],M=[],ct=[],Gt=Promise.resolve(),W=!1;function Wt(){W||(W=!0,Gt.then(ht))}function X(e){M.push(e)}var G=new Set,F=0;function ht(){if(F!==0)return;let e=Z;do{try{for(;F<S.length;){let t=S[F];F++,A(t),Xt(t.$$)}}catch(t){throw S.length=0,F=0,t}for(A(null),S.length=0,F=0;H.length;)H.pop()();for(let t=0;t<M.length;t+=1){let o=M[t];G.has(o)||(G.add(o),o())}M.length=0}while(S.length);for(;ct.length;)ct.pop()();W=!1,G.clear(),A(e)}function Xt(e){if(e.fragment!==null){e.update(),D(e.before_update);let t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(X)}}function Yt(e){let t=[],o=[];M.forEach(i=>e.indexOf(i)===-1?t.push(i):o.push(i)),o.forEach(i=>i()),M=t}var Jt=new Set;function Zt(e,t){e&&e.i&&(Jt.delete(e),e.i(t))}var be=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var Qt=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],we=new Set([...Qt]);function te(e,t,o,i){let{fragment:r,after_update:l}=e.$$;r&&r.m(t,o),i||X(()=>{let u=e.$$.on_mount.map(Y).filter(N);e.$$.on_destroy?e.$$.on_destroy.push(...u):D(u),e.$$.on_mount=[]}),l.forEach(X)}function pt(e,t){let o=e.$$;o.fragment!==null&&(Yt(o.after_update),D(o.on_destroy),o.fragment&&o.fragment.d(t),o.on_destroy=o.fragment=null,o.ctx=[])}function ee(e,t){e.$$.dirty[0]===-1&&(S.push(e),Wt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function mt(e,t,o,i,r,l,u,f=[-1]){let m=Z;A(e);let h=e.$$={fragment:null,ctx:[],props:l,update:b,not_equal:r,bound:st(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:st(),dirty:f,skip_bound:!1,root:t.target||m.$$.root};u&&u(h.root);let g=!1;if(h.ctx=o?o(e,t.props||{},(y,a,...E)=>{let w=E.length?E[0]:a;return h.ctx&&r(h.ctx[y],h.ctx[y]=w)&&(!h.skip_bound&&h.bound[y]&&h.bound[y](w),g&&ee(e,y)),a}):[],h.update(),g=!0,D(h.before_update),h.fragment=i?i(h.ctx):!1,t.target){if(t.hydrate){Kt();let y=Vt(t.target);h.fragment&&h.fragment.l(y),y.forEach(I)}else h.fragment&&h.fragment.c();t.intro&&Zt(e.$$.fragment),te(e,t.target,t.anchor,t.customElement),Ut(),ht()}A(m)}var ne;typeof HTMLElement=="function"&&(ne=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(Y).filter(N);for(let t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(e,t,o){this[e]=o}disconnectedCallback(){D(this.$$.on_disconnect)}$destroy(){pt(this,1),this.$destroy=b}$on(e,t){if(!N(t))return b;let o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{let i=o.indexOf(t);i!==-1&&o.splice(i,1)}}$set(e){this.$$set&&!lt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});var q=class{$destroy(){pt(this,1),this.$destroy=b}$on(t,o){if(!N(o))return b;let i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(o),()=>{let r=i.indexOf(o);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!lt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}};var O=[];function _t(e,t=b){let o,i=new Set;function r(f){if(L(e,f)&&(e=f,o)){let m=!O.length;for(let h of i)h[1](),O.push(h,e);if(m){for(let h=0;h<O.length;h+=2)O[h][0](O[h+1]);O.length=0}}}function l(f){r(f(e))}function u(f,m=b){let h=[f,m];return i.add(h),i.size===1&&(o=t(r)||b),f(e),()=>{i.delete(h),i.size===0&&o&&(o(),o=null)}}return{set:r,update:l,subscribe:u}}var St=zt(gt());var bt=(e,t)=>{let o=Object.keys(e);return o.length!==Object.keys(t).length?!1:o.every(i=>Object.prototype.hasOwnProperty.call(t,i)&&e[i]===t[i])},oe=(e,t)=>e.length===t.length&&e.every((o,i)=>bt(o,t[i])),ie=(e,t)=>{if(e.length<t.length)return!1;let o=e.length-t.length;for(let i=t.length-1;i>=0;i-=1)if(!bt(e[o+i],t[i]))return!1;return!0},wt=e=>e.reduce((t,o)=>({...t,[o]:!0}),{}),vt=["ctrl","shift","alt","meta"],re=wt(vt),se=e=>Object.keys(e).filter(t=>!re[t]).length===1,B=(e,t)=>{if(!e)throw new Error(t)},K=(e,t,o)=>{B(typeof e===o,`The ${t} must be a ${o}; given ${typeof e}`)},Et=e=>e.split(/ +/g).map(t=>{let o=t.split("+").filter(Boolean),i=wt(o);return B(Object.keys(i).length>=o.length,`Hotkey combination has duplicates "${e}"`),B(se(i),`Invalid hotkey combination: "${e}"`),i}),ce=(e,t)=>{K(e,"hotkey","string"),K(t,"callback","function")},yt=(e,t)=>(o,i)=>{ce(o,i),t(e,o,i)},le=(e,t,o)=>{e.push({hotkey:Et(t),callback:o})},ae=(e,t,o)=>{let i=Et(t),r=e.findIndex(l=>l.callback===o&&oe(i,l.hotkey));r!==-1&&e.splice(r,1)},ue=(e,t)=>{let o=null;return()=>{clearTimeout(o),o=setTimeout(e,t)}},fe=e=>{switch(e){case"+":return"plus";case" ":return"space";default:return e.toLowerCase()}},de=(e,t)=>{let o=[],i=ue(()=>{o=[]},t);return r=>{if(r.repeat||r.getModifierState(r.key))return;i();let l={[fe(r.key)]:!0};vt.forEach(u=>{r[`${u}Key`]&&(l[u]=!0)}),o.push(l),e.forEach(u=>{ie(o,u.hotkey)&&u.callback(r)})}},he=e=>{let{debounceTime:t=500,autoEnable:o=!0}=e||{};return K(t,"debounceTime","number"),B(t>0,"debounceTime must be > 0"),K(o,"autoEnable","boolean"),{debounceTime:t,autoEnable:o}},xt=e=>{let{debounceTime:t,autoEnable:o}=he(e),i=[],r=de(i,t),l=()=>document.addEventListener("keydown",r),u=()=>document.removeEventListener("keydown",r);return o&&l(),{register:yt(i,le),unregister:yt(i,ae),enable:l,disable:u}};function kt(e,t,o){let i=e.slice();i[7]=t[o];let r=i[2][i[7]];return i[8]=r,i}function $t(e){let t,o,i=e[7]+"",r,l,u,f=e[8].enabled?"Disable":"Enable",m,h,g,y,a,E;function w(){return e[3](e[7])}return{c(){t=T("div"),o=T("h1"),r=j(i),l=J(),u=T("button"),m=j(f),h=J(),k(o,"class","PopcornUI-theme-id"),k(u,"class","PopcornUI-theme-toggle"),k(t,"class","PopcornUI-theme"),k(t,"id",g=e[7]),k(t,"data-enabled",y=e[8].enabled)},m($,R){z($,t,R),x(t,o),x(o,r),x(t,l),x(t,u),x(u,m),x(t,h),a||(E=dt(u,"click",w),a=!0)},p($,R){e=$},d($){$&&I(t),a=!1,E()}}}function Ft(e){let t=e[1]?.[e[7]],o,i=$t(e);return{c(){i.c(),o=ft()},m(r,l){i.m(r,l),z(r,o,l)},p(r,l){l&2&&L(t,t=r[1]?.[r[7]])?(i.d(1),i=$t(r),i.c(),i.m(o.parentNode,o)):i.p(r,l)},d(r){r&&I(o),i.d(r)}}}function pe(e){let t,o,i=Object.keys(e[2]),r=[];for(let l=0;l<i.length;l+=1)r[l]=Ft(kt(e,i,l));return{c(){t=T("dialog"),o=T("div");for(let l=0;l<r.length;l+=1)r[l].c();k(o,"class","PopcornUI-themes-wrapper"),k(t,"class","PopcornUI-dialog")},m(l,u){z(l,t,u),x(t,o);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(o,null);e[4](t)},p(l,[u]){if(u&6){i=Object.keys(l[2]);let f;for(f=0;f<i.length;f+=1){let m=kt(l,i,f);r[f]?r[f].p(m,u):(r[f]=Ft(m),r[f].c(),r[f].m(o,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=i.length}},i:b,o:b,d(l){l&&I(t),ut(r,l),e[4](null)}}}var et=_t();function Mt(e){et.set(e)}function me(e,t,o){let i=Popcorn.themes,r;let l=!1;function u(){l?r.close():r.showModal(),l=!l,document.documentElement.dataset.popcornUiOpen=l.toString()}PopcornNative.config.then(g=>{let y=xt();y.register(g.hotkey,a=>{a.stopImmediatePropagation(),u()}),y.register("escape",a=>{l&&(a.stopImmediatePropagation(),u())})});let f={};et.subscribe(g=>{o(1,f[g]=!f?.[g],f),et.set(null)});let m=g=>window.Popcorn.toggle(g);function h(g){H[g?"unshift":"push"](()=>{r=g,o(0,r)})}return[r,f,i,m,h]}var nt=class extends q{constructor(t){super(),mt(this,t,me,pe,L,{})}},Dt=nt;var Tt={str:"gold",arr:[255,215,0]},ot=class{module;output;constructor(t,o="console"){this.module=t,this.output=this.#e(o)}#e(t){switch(t){case"ansi":case"terminal":return"ansi";default:return"console"}}#n(t){switch(t){case"info":case"warn":case"error":case"debug":return t;default:return"log"}}#o(t){switch(t){case"debug":return{str:"MediumSpringGreen",arr:[0,250,154]};case"info":return{str:"DeepSkyBlue",arr:[0,191,255]};case"error":return{str:"crimson",arr:[220,20,60]};case"warn":return{str:"DarkOrange",arr:[255,140,0]};default:return null}}#i(t,o){return`\x1B[38;2;${t[0]};${t[1]};${t[2]}m${o}\x1B[0m`}#t(t,o){let i=this.#o(t)??Tt,r=this.output==="ansi"?[`[${this.#i(i.arr,"Popcorn")} > ${this.module}]`]:[`[%cPopcorn%c > ${this.module}]`,`color: ${i.str||Tt.str};`,""];console[this.#n(t)](...r,...o)}log=(...t)=>this.#t("log",t);info=(...t)=>this.#t("info",t);warn=(...t)=>this.#t("warn",t);error=(...t)=>this.#t("error",t);debug=(...t)=>this.#t("debug",t)},U=ot;var Ze=new U("Proxy"),Ot={get(e,t){return typeof e[t]=="object"&&e[t]!==null?new Proxy(e[t],this):e[t]},set:(e,t,o)=>(Mt(e.id),e[t]=o,!0)};var P=new U("Renderer"),_e=await PopcornNative.config,sn=new class{comments;themeElements=new Map;themeProxy;constructor(){V(this)}async start(){let o={themes:await PopcornNative.getThemes(),enable:this.enable,disable:this.disable,toggle:this.toggle};this.themeProxy=new Proxy(o.themes,Ot),o.themes=this.themeProxy,window.Popcorn=o;let i=document.createComment("section:Popcorn"),r=document.createComment("endsection");document.head.append(i,r),this.comments={start:i,end:r},new Dt({target:document.body}),this.populateThemes(),this.watchThemes()}async populateThemes(){for(let t of Object.keys(this.themeProxy)){let o=this.themeProxy[t];this.populateTheme(t),o.enabled&&await this.enable(t,!1)}}async watchThemes(){PopcornNative.onThemeChange(({id:t,theme:o})=>{_e.verbose&&P.debug(`Theme changed: ${t}`),this.themeProxy[t]=o,this.populateTheme(t),this.updateTheme(t)})}async updateTheme(t){let o=this.themeElements.get(t);if(!o){P.warn(`No theme found with id: "${t}"`);return}o.textContent=this.themeProxy[t].css}async populateTheme(t){let o=this.themeProxy[t];o.enable=(i,r=!0)=>this.enable(i,r),o.disable=(i,r=!0)=>this.disable(i,r),o.toggle=(i,r=!0)=>this.toggle(i,r)}async enable(t,o=!0){let i=this.themeProxy[t];if(i.enabled=!0,this.themeElements.has(t)){P.log(`"${t}" is already enabled.`);return}let r=document.createElement("style");r.id=t,r.textContent=i.css,r.dataset.popcorn="true",this.comments.end.before(r),this.themeElements.set(t,r),PopcornNative.watchTheme(JSON.stringify(i)),P.log(`"${t}" enabled.`),o&&PopcornNative.saveState(t,!0)}async disable(t,o=!0){let i=this.themeProxy[t];i.enabled=!1;let r=this.themeElements.get(t);if(!r){P.warn(`"${t}" is not enabled.`);return}this.themeElements.delete(t),r.remove(),PopcornNative.unwatchTheme(JSON.stringify(i)),P.log(`"${t}" disabled.`),o&&PopcornNative.saveState(t,!1)}async toggle(t,o=!0){this.themeProxy[t].enabled?this.disable(t,o):this.enable(t,o)}async stop(){delete window.Popcorn;let t=[...document.querySelectorAll("[data-popcorn]"),...Object.values(this.comments)];for(let o of t)o.remove()}};export{sn as default};
