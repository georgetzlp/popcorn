var h=n=>{let e=new Set;do for(let t of Reflect.ownKeys(n))e.add([n,t]);while((n=Reflect.getPrototypeOf(n))&&n!==Object.prototype);return e};function c(n,{include:e,exclude:t}={}){let o=r=>{let s=a=>typeof a=="string"?r===a:a.test(r);return e?e.some(s):t?!t.some(s):!0};for(let[r,s]of h(n.constructor.prototype)){if(s==="constructor"||!o(s))continue;let a=Reflect.getOwnPropertyDescriptor(r,s);a&&typeof a.value=="function"&&(n[s]=n[s].bind(n))}return n}var u={arr:[255,215,0],str:"gold"},l=class{module;output;constructor(e,t="console"){this.module=e,this.output=this.#t(t)}#t(e){switch(e){case"ansi":case"terminal":return"ansi";default:return"console"}}#r(e){switch(e){case"info":case"warn":case"error":case"debug":return e;default:return"log"}}#n(e){switch(e){case"debug":return{str:"royalblue",arr:[65,105,225]};case"error":return{str:"crimson",arr:[220,20,60]};case"warn":return{str:"orange",arr:[255,165,0]};default:return{str:null,arr:null}}}#o(e,t){return`\x1B[38;2;${e[0]};${e[1]};${e[2]}m${t}\x1B[0m`}#e(e,t){let o=this.output==="ansi"?[`[${this.#o(u.arr,"Popcorn")} > ${this.module}]`]:[`[%cPopcorn%c > ${this.module}]`,`color: ${u.str};`,""];console[this.#r(e)](...o,...t)}log=(...e)=>this.#e("log",e);info=(...e)=>this.#e("info",e);warn=(...e)=>this.#e("warn",e);error=(...e)=>this.#e("error",e);debug=(...e)=>this.#e("debug",e)},i=l;var y=new i("Proxy"),p={get(n,e){return typeof n[e]=="object"&&n[e]!==null?new Proxy(n[e],this):n[e]},set:(n,e,t)=>(n[e]=t,!0)};var m=new i("Renderer"),$=new class{comments;themeElements=new Map;proxy;constructor(){c(this)}async start(){let t={themes:await PopcornNative.getThemes(),enable:this.enable,disable:this.disable,toggle:this.toggle};window.Popcorn=t,this.proxy=new Proxy(t.themes,p),window.Popcorn.themes=this.proxy;let o=document.createComment("section:Popcorn"),r=document.createComment("endsection");document.head.append(o,r),this.comments={start:o,end:r},this.populateThemes()}async populateThemes(){for(let e of Object.keys(this.proxy)){let t=this.proxy[e];this.populateTheme(e),m.log(e,t),t.enabled&&await this.enable(e,!1)}}async populateTheme(e){let t=this.proxy[e];t.enable=(o,r=!0)=>this.enable(o,r),t.disable=(o,r=!0)=>this.disable(o,r),t.toggle=(o,r=!0)=>this.toggle(o,r)}async enable(e,t=!0){let o=this.proxy[e];if(o.enabled=!0,this.themeElements.has(e)){m.log(`"${e}" is already enabled.`);return}let r=document.createElement("style");r.id=e,r.textContent=o.css,r.dataset.popcorn="true",this.comments.end.before(r),this.themeElements.set(e,r),t&&PopcornNative.saveState(e,!0)}async disable(e,t=!0){let o=this.proxy[e];o.enabled=!1;let r=this.themeElements.get(e);if(!r){m.warn(`"${e}" is not enabled.`);return}this.themeElements.delete(e),r.remove(),t&&PopcornNative.saveState(e,!1)}async toggle(e,t=!0){let o=this.proxy[e];o.enabled=!o.enabled,o.enabled?await this.enable(e,t):await this.disable(e,t)}async stop(){delete window.Popcorn;let e=[...document.querySelectorAll("[data-popcorn]"),...Object.values(this.comments)];for(let t of e)t.remove()}};export{$ as default};
