var u=s=>{let e=new Set;do for(let t of Reflect.ownKeys(s))e.add([s,t]);while((s=Reflect.getPrototypeOf(s))&&s!==Object.prototype);return e};function c(s,{include:e,exclude:t}={}){let o=n=>{let r=a=>typeof a=="string"?n===a:a.test(n);return e?e.some(r):t?!t.some(r):!0};for(let[n,r]of u(s.constructor.prototype)){if(r==="constructor"||!o(r))continue;let a=Reflect.getOwnPropertyDescriptor(n,r);a&&typeof a.value=="function"&&(s[r]=s[r].bind(s))}return s}var m={arr:[255,215,0],str:"rgb(255, 215, 0)"},l=class{module;output;constructor(e,t="console"){this.module=e,this.output=this.#t(t)}#t(e){switch(e){case"ansi":case"terminal":return"ansi";default:return"console"}}#n(e){switch(e){case"info":case"warn":case"error":case"debug":return e;default:return"log"}}#o(e,t){return`\x1B[38;2;${e[0]};${e[1]};${e[2]}m${t}\x1B[0m`}#e(e,t){let o=this.output==="ansi"?[`[${this.#o(m.arr,"Popcorn")} > ${this.module}]`]:[`[%cPopcorn%c > ${this.module}]`,`color: ${m.str};`,""];console[this.#n(e)](...o,...t)}log=(...e)=>this.#e("log",e);info=(...e)=>this.#e("info",e);warn=(...e)=>this.#e("warn",e);error=(...e)=>this.#e("error",e);debug=(...e)=>this.#e("debug",e)},h=l;var i=new h("Renderer"),y=new class{comments;themeElements=new Map;constructor(){let e=document.createComment("section:Popcorn"),t=document.createComment("endsection");document.head.append(e,t),this.comments={start:e,end:t},c(this)}async start(){let t={themes:await PopcornNative.getThemes(),enable:this.enable,disable:this.disable,toggle:this.toggle};window.Popcorn=t,await this.populateThemes()}async populateThemes(){for(let e of Object.keys(Popcorn.themes)){let t=Popcorn.themes[e];t.enable=(o,n=!0)=>this.enable(o,n),t.disable=(o,n=!0)=>this.disable(o,n),t.toggle=(o,n=!0)=>this.toggle(o,n),i.log(e,t),t.enabled&&await this.enable(e,!1)}}async enable(e,t=!0){let o=Popcorn.themes[e];if(o.enabled=!0,this.themeElements.has(e)){i.log(`"${e}" is already enabled.`);return}let n=document.createElement("style");n.id=e,n.textContent=o.css,n.dataset.popcorn="true",this.comments.end.before(n),this.themeElements.set(e,n),t&&i.log("\u{1F92F}\u{1F92F}\u{1F92F}")}async disable(e,t=!0){let o=Popcorn.themes[e];o.enabled=!1;let n=this.themeElements.get(e);if(!n){i.warn(`"${e}" is not enabled.`);return}this.themeElements.delete(e),n.remove(),t&&i.log("\u{1F92F}\u{1F92F}\u{1F92F}")}async toggle(e,t=!0){let o=Popcorn.themes[e];o.enabled=!o.enabled,o.enabled?await this.enable(e,t):await this.disable(e,t)}async stop(){delete window.Popcorn;let e=[...document.querySelectorAll("[data-popcorn]"),...Object.values(this.comments)];for(let t of e)t.remove()}};export{y as default};
