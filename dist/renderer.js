var u=r=>{let e=new Set;do for(let t of Reflect.ownKeys(r))e.add([r,t]);while((r=Reflect.getPrototypeOf(r))&&r!==Object.prototype);return e};function c(r,{include:e,exclude:t}={}){let n=o=>{let s=a=>typeof a=="string"?o===a:a.test(o);return e?e.some(s):t?!t.some(s):!0};for(let[o,s]of u(r.constructor.prototype)){if(s==="constructor"||!n(s))continue;let a=Reflect.getOwnPropertyDescriptor(o,s);a&&typeof a.value=="function"&&(r[s]=r[s].bind(r))}return r}var p={arr:[255,215,0],str:"rgb(255, 215, 0)"},l=class{module;output;constructor(e,t="console"){this.module=e,this.output=this.#t(t)}#t(e){switch(e){case"ansi":case"terminal":return"ansi";default:return"console"}}#o(e){switch(e){case"info":case"warn":case"error":case"debug":return e;default:return"log"}}#n(e,t){return`\x1B[38;2;${e[0]};${e[1]};${e[2]}m${t}\x1B[0m`}#e(e,t){let n=this.output==="ansi"?[`[${this.#n(p.arr,"Popcorn")} > ${this.module}]`]:[`[%cPopcorn%c > ${this.module}]`,`color: ${p.str};`,""];console[this.#o(e)](...n,...t)}log=(...e)=>this.#e("log",e);info=(...e)=>this.#e("info",e);warn=(...e)=>this.#e("warn",e);error=(...e)=>this.#e("error",e);debug=(...e)=>this.#e("debug",e)},i=l;var y=new i("Proxy"),h={get(r,e){return typeof r[e]=="object"&&r[e]!==null?new Proxy(r[e],this):r[e]},set:(r,e,t)=>(r[e]=t,!0)};var m=new i("Renderer"),$=new class{comments;themeElements=new Map;proxy;constructor(){c(this)}async start(){let t={themes:await PopcornNative.getThemes(),enable:this.enable,disable:this.disable,toggle:this.toggle};window.Popcorn=t,this.proxy=new Proxy(t.themes,h),window.Popcorn.themes=this.proxy;let n=document.createComment("section:Popcorn"),o=document.createComment("endsection");document.head.append(n,o),this.comments={start:n,end:o},this.populateThemes()}async populateThemes(){for(let e of Object.keys(this.proxy)){let t=this.proxy[e];this.populateTheme(e),m.log(e,t),t.enabled&&await this.enable(e,!1)}}async populateTheme(e){let t=this.proxy[e];t.enable=(n,o=!0)=>this.enable(n,o),t.disable=(n,o=!0)=>this.disable(n,o),t.toggle=(n,o=!0)=>this.toggle(n,o)}async enable(e,t=!0){let n=this.proxy[e];if(n.enabled=!0,this.themeElements.has(e)){m.log(`"${e}" is already enabled.`);return}let o=document.createElement("style");o.id=e,o.textContent=n.css,o.dataset.popcorn="true",this.comments.end.before(o),this.themeElements.set(e,o),t&&PopcornNative.saveState(e,!0)}async disable(e,t=!0){let n=this.proxy[e];n.enabled=!1;let o=this.themeElements.get(e);if(!o){m.warn(`"${e}" is not enabled.`);return}this.themeElements.delete(e),o.remove(),t&&PopcornNative.saveState(e,!1)}async toggle(e,t=!0){let n=this.proxy[e];n.enabled=!n.enabled,n.enabled?await this.enable(e,t):await this.disable(e,t)}async stop(){delete window.Popcorn;let e=[...document.querySelectorAll("[data-popcorn]"),...Object.values(this.comments)];for(let t of e)t.remove()}};export{$ as default};
